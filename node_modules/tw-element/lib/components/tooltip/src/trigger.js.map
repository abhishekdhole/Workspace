{"version":3,"file":"trigger.js","sources":["../../../../../../packages/components/tooltip/src/trigger.vue"],"sourcesContent":["<template>\n  <el-popper-trigger\n    :id=\"id\"\n    :virtual-ref=\"virtualRef\"\n    :open=\"open\"\n    :virtual-triggering=\"virtualTriggering\"\n    :class=\"ns.e('trigger')\"\n    @blur=\"onBlur\"\n    @click=\"onClick\"\n    @contextmenu=\"onContextMenu\"\n    @focus=\"onFocus\"\n    @mouseenter=\"onMouseenter\"\n    @mouseleave=\"onMouseleave\"\n    @keydown=\"onKeydown\"\n  >\n    <slot />\n  </el-popper-trigger>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, inject, ref, unref, toRef } from 'vue'\nimport { TwPopperTrigger } from '@tw-element/components/popper'\nimport { composeEventHandlers } from '@tw-element/utils'\nimport { EVENT_CODE } from '@tw-element/constants'\nimport { useNamespace } from '@tw-element/hooks'\nimport { TOOLTIP_INJECTION_KEY } from './tokens'\nimport { useTooltipTriggerProps } from './tooltip'\nimport { whenTrigger } from './utils'\n\nimport type { ElOnlyChildExpose } from '@tw-element/components/slot'\n\nexport default defineComponent({\n  name: 'ElTooltipTrigger',\n  components: {\n    TwPopperTrigger,\n  },\n  props: useTooltipTriggerProps,\n  setup(props) {\n    const ns = useNamespace('tooltip')\n    const { controlled, id, open, onOpen, onClose, onToggle } = inject(\n      TOOLTIP_INJECTION_KEY,\n      undefined\n    )!\n    const triggerRef = ref<ElOnlyChildExpose | null>(null)\n\n    const stopWhenControlledOrDisabled = () => {\n      if (unref(controlled) || props.disabled) {\n        return true\n      }\n    }\n    const trigger = toRef(props, 'trigger')\n    const onMouseenter = composeEventHandlers(\n      stopWhenControlledOrDisabled,\n      whenTrigger(trigger, 'hover', onOpen)\n    )\n    const onMouseleave = composeEventHandlers(\n      stopWhenControlledOrDisabled,\n      whenTrigger(trigger, 'hover', onClose)\n    )\n    const onClick = composeEventHandlers(\n      stopWhenControlledOrDisabled,\n      whenTrigger(trigger, 'click', (e) => {\n        // distinguish left click\n        if ((e as MouseEvent).button === 0) {\n          onToggle(e)\n        }\n      })\n    )\n\n    const onFocus = composeEventHandlers(\n      stopWhenControlledOrDisabled,\n      whenTrigger(trigger, 'focus', onOpen)\n    )\n\n    const onBlur = composeEventHandlers(\n      stopWhenControlledOrDisabled,\n      whenTrigger(trigger, 'focus', onClose)\n    )\n\n    const onContextMenu = composeEventHandlers(\n      stopWhenControlledOrDisabled,\n      whenTrigger(trigger, 'contextmenu', (e: Event) => {\n        e.preventDefault()\n        onToggle(e)\n      })\n    )\n\n    const onKeydown = composeEventHandlers(\n      stopWhenControlledOrDisabled,\n      (e: KeyboardEvent) => {\n        const { code } = e\n        if (code === EVENT_CODE.enter || code === EVENT_CODE.space) {\n          onToggle(e)\n        }\n      }\n    )\n\n    return {\n      onBlur,\n      onContextMenu,\n      onFocus,\n      onMouseenter,\n      onMouseleave,\n      onClick,\n      onKeydown,\n      open,\n      id,\n      triggerRef,\n      ns,\n    }\n  },\n})\n</script>\n"],"names":["defineComponent","TwPopperTrigger","useTooltipTriggerProps","useNamespace","inject","TOOLTIP_INJECTION_KEY","ref","unref","toRef","composeEventHandlers","whenTrigger","EVENT_CODE","_openBlock","_createBlock","_normalizeClass","_withCtx"],"mappings":";;;;;;;;;;;;;;;;;;AA+BA,MAAK,YAAaA,oBAAa;AAAA,EAC7B,MAAM;AAAA,EACN,YAAY;AAAA,qBACVC;AAAA;AAAA,EAEF,OAAOC;AAAA,EACP,MAAM,OAAO;AACX,UAAM,KAAKC,mBAAa;AACxB,UAAM,EAAE,YAAY,IAAI,MAAM,QAAQ,SAAS,aAAaC,WAC1DC,8BACA;AAEF,UAAM,aAAaC,QAA8B;AAEjD,UAAM,+BAA+B,MAAM;AACzC,UAAIC,UAAM,eAAe,MAAM,UAAU;AACvC,eAAO;AAAA;AAAA;AAGX,UAAM,UAAUC,UAAM,OAAO;AAC7B,UAAM,eAAeC,2BACnB,8BACAC,kBAAY,SAAS,SAAS;AAEhC,UAAM,eAAeD,2BACnB,8BACAC,kBAAY,SAAS,SAAS;AAEhC,UAAM,UAAUD,2BACd,8BACAC,kBAAY,SAAS,SAAS,CAAC,MAAM;AAEnC,UAAK,EAAiB,WAAW,GAAG;AAClC,iBAAS;AAAA;AAAA;AAKf,UAAM,UAAUD,2BACd,8BACAC,kBAAY,SAAS,SAAS;AAGhC,UAAM,SAASD,2BACb,8BACAC,kBAAY,SAAS,SAAS;AAGhC,UAAM,gBAAgBD,2BACpB,8BACAC,kBAAY,SAAS,eAAe,CAAC,MAAa;AAChD,QAAE;AACF,eAAS;AAAA;AAIb,UAAM,YAAYD,2BAChB,8BACA,CAAC,MAAqB;AACpB,YAAM,EAAE,SAAS;AACjB,UAAI,SAASE,gBAAW,SAAS,SAASA,gBAAW,OAAO;AAC1D,iBAAS;AAAA;AAAA;AAKf,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA;AAAA;AAAA;;;SA1GGC,iBAAEC;AAAA,IACN;AAAA,IACA,eAAU;AAAA,IACV;AAAA,IACA,sBAAK,KAAE;AAAA,IACP,OAAIC,mBAAQ;AAAA,IACZ,QAAK,KAAE;AAAA,IACP,cAAW;AAAA,IACX,eAAO;AAAA,IACP,cAAY;AAAA,IACZ,cAAY;AAAA,IACZ,cAAS;AAAA;;aAEVC,YAAQ;AAAA;;;;;;;;;"}